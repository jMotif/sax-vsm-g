##
## This code supports the WiKi tutorial on the motif frequency search.
##
## last edited 3-27-2010, seninp@gmail.com
##

## source the R code
#
source("../../RCode/SAX/PAA_SAX.R")

## example data definitions
#
ts.name <- "qtdbsele0606.txt"
ts1.name <- "mitdbx_mitdbx_108.txt"

## load the data
#
ts.data <- znorm(as.matrix(read.csv(file=ts.name, header=FALSE, sep = "\t", quote="\"", dec=".", fill = TRUE, comment.char="")))
ts1.data <- as.matrix(read.csv(file=ts1.name, header=FALSE, sep = "\t", quote="\"", dec=".", fill = TRUE, comment.char=""))

par(mfrow=c(3, 1))

plot(NULL, xlim=c(0,16600), ylim=c(min(ts1.data[,2]), max(ts1.data[,2])), xlab="", ylab="")
lines(ts1.data[,2], col="red", lwd=1)
lines(seq(9941,10541),ts1.data[9941:10541,2], col="blue", lwd=3)

abline(v=c(865, 13996, 5977, 9997, 9939, 11289, 14328, 11304, 1543, 13974, 1533, 10512, 11302, 10578, 10405, 11300, 9988, 9985, 15530, 13994, 13995, 700, 5232, 14001, 15121, 13989, 13101, 2365, 14327, 1659, 13993, 9059, 9945, 1664, 9743, 890, 10394, 4483, 655, 10538, 879, 1221, 12434, 10393, 10404, 10915, 13992, 11615, 11292, 15087, 10926, 1532, 14326, 13991, 13990, 3464, 1214, 10579, 11972, 12061, 11310, 9579, 988, 11608, 15531, 12430, 1552, 11290, 2364, 1674, 15054, 10590, 10518, 14325, 7152, 1199, 701, 11298, 11307, 11294, 1542, 12433, 11296, 9996, 4565, 3445, 885, 4484, 14324, 14726, 1531, 2840, 9041, 1219, 9744, 14323, 9058, 15532, 2363, 10562, 13964, 12432, 2009, 987, 1223, 10580, 2747, 5233, 12431, 1208, 14322, 10043, 11971, 9940, 1997, 2763, 862, 15090, 1986, 9552, 1657, 3109, 9943, 1222, 15097, 11293, 10432, 2362, 702, 1582, 1530, 3390, 7610, 10914, 9745, 10395, 1541, 1192, 11291, 14321, 14012, 11301, 6332, 11303, 1523, 5976, 10018, 15533, 9984, 10511, 9547, 10589, 1293, 12384, 14000, 883, 10937, 2361, 12436, 9549, 14694, 1663, 11616, 11305, 14320, 656, 10517, 2360, 9942, 986, 11295, 7151, 9987, 10581, 887, 882, 10547, 9995, 1658, 14013, 11299, 855, 3465, 12104, 14319, 10603, 870, 15107, 1220, 10599, 1673, 9845, 11297, 1540, 14318, 9057, 871, 15534, 3164, 9941))


plot(NULL, xlim=c(8000,12000), ylim=c(min(ts1.data[,2]), max(ts1.data[,2])), xlab="", ylab="")
lines(ts1.data[,2], col="red", lwd=1)
lines(seq(9941,10541),ts1.data[9941:10541,2], col="blue", lwd=3)
abline(v=c(865, 13996, 5977, 9997, 9939, 11289, 14328, 11304, 1543, 13974, 1533, 10512, 11302, 10578, 10405, 11300, 9988, 9985, 15530, 13994, 13995, 700, 5232, 14001, 15121, 13989, 13101, 2365, 14327, 1659, 13993, 9059, 9945, 1664, 9743, 890, 10394, 4483, 655, 10538, 879, 1221, 12434, 10393, 10404, 10915, 13992, 11615, 11292, 15087, 10926, 1532, 14326, 13991, 13990, 3464, 1214, 10579, 11972, 12061, 11310, 9579, 988, 11608, 15531, 12430, 1552, 11290, 2364, 1674, 15054, 10590, 10518, 14325, 7152, 1199, 701, 11298, 11307, 11294, 1542, 12433, 11296, 9996, 4565, 3445, 885, 4484, 14324, 14726, 1531, 2840, 9041, 1219, 9744, 14323, 9058, 15532, 2363, 10562, 13964, 12432, 2009, 987, 1223, 10580, 2747, 5233, 12431, 1208, 14322, 10043, 11971, 9940, 1997, 2763, 862, 15090, 1986, 9552, 1657, 3109, 9943, 1222, 15097, 11293, 10432, 2362, 702, 1582, 1530, 3390, 7610, 10914, 9745, 10395, 1541, 1192, 11291, 14321, 14012, 11301, 6332, 11303, 1523, 5976, 10018, 15533, 9984, 10511, 9547, 10589, 1293, 12384, 14000, 883, 10937, 2361, 12436, 9549, 14694, 1663, 11616, 11305, 14320, 656, 10517, 2360, 9942, 986, 11295, 7151, 9987, 10581, 887, 882, 10547, 9995, 1658, 14013, 11299, 855, 3465, 12104, 14319, 10603, 870, 15107, 1220, 10599, 1673, 9845, 11297, 1540, 14318, 9057, 871, 15534, 3164, 9941))

plot(NULL, xlim=c(9500,11500), ylim=c(min(ts1.data[,2]), max(ts1.data[,2])), xlab="", ylab="")
lines(ts1.data[,2], col="red", lwd=1)
lines(seq(9941,10541),ts1.data[9941:10541,2], col="blue", lwd=3)
abline(v=c(865, 13996, 5977, 9997, 9939, 11289, 14328, 11304, 1543, 13974, 1533, 10512, 11302, 10578, 10405, 11300, 9988, 9985, 15530, 13994, 13995, 700, 5232, 14001, 15121, 13989, 13101, 2365, 14327, 1659, 13993, 9059, 9945, 1664, 9743, 890, 10394, 4483, 655, 10538, 879, 1221, 12434, 10393, 10404, 10915, 13992, 11615, 11292, 15087, 10926, 1532, 14326, 13991, 13990, 3464, 1214, 10579, 11972, 12061, 11310, 9579, 988, 11608, 15531, 12430, 1552, 11290, 2364, 1674, 15054, 10590, 10518, 14325, 7152, 1199, 701, 11298, 11307, 11294, 1542, 12433, 11296, 9996, 4565, 3445, 885, 4484, 14324, 14726, 1531, 2840, 9041, 1219, 9744, 14323, 9058, 15532, 2363, 10562, 13964, 12432, 2009, 987, 1223, 10580, 2747, 5233, 12431, 1208, 14322, 10043, 11971, 9940, 1997, 2763, 862, 15090, 1986, 9552, 1657, 3109, 9943, 1222, 15097, 11293, 10432, 2362, 702, 1582, 1530, 3390, 7610, 10914, 9745, 10395, 1541, 1192, 11291, 14321, 14012, 11301, 6332, 11303, 1523, 5976, 10018, 15533, 9984, 10511, 9547, 10589, 1293, 12384, 14000, 883, 10937, 2361, 12436, 9549, 14694, 1663, 11616, 11305, 14320, 656, 10517, 2360, 9942, 986, 11295, 7151, 9987, 10581, 887, 882, 10547, 9995, 1658, 14013, 11299, 855, 3465, 12104, 14319, 10603, 870, 15107, 1220, 10599, 1673, 9845, 11297, 1540, 14318, 9057, 871, 15534, 3164, 9941))



#plot(NULL, xlim=c(0,15000), ylim=c(min(ts1.data[,3]), max(ts1.data[,3])), xlab="", ylab="")
#lines(ts1.data[,3], col="red", lwd=1)


#plot(NULL, xlim=c(1000,1500), ylim=c(min(ts.data[,2]), max(ts.data[,2])), xlab="", ylab="")

stop()

positions <- c(1, 25, 26, 28, 53, 86, 113, 115, 7122)
for(i in c(1:9)){
 lines(c(positions[i]:(positions[i]+300)), ts.data[positions[i]:(positions[i]+300),2], col="blue", lwd=2)
}

## get the series dimensions
ts.length <- max(dim(ts2.data)[2], dim(ts1.data)[2])
ts.max <- max(max(ts2.data), max(ts1.data))

## plot the raw data
#
library(Cairo)
Cairo(width = 460, height = 320, file="raw_data.png", type="png", pointsize=9,
bg = "white", canvas = "white", units = "px", dpi = 300)
plot(NULL, xlim=c(0,16), ylim=c(0,10), main="PAA example: raw timeseries", 
	xlab="Time ticks", ylab="Values", xaxt="n", cex.main=2, cex.axis=1.6, cex.lab=1.8)
axis(1,at=seq(0, 17, by = 2), cex.axis=1.6)
i<-0; while(i < 11){
 abline(h=i, lty=2, lwd=1, col="darkolivegreen3"); i <- i+2;
}
i<-0; while(i < 17){
 abline(v=i, lty=2, lwd=1, col="darkolivegreen3"); i <- i+2;
}
lines(ts1.data[1,], lwd=2, col="mediumspringgreen")
points(ts1.data[1,], pch=3, cex=1, col="mediumspringgreen")
lines(ts2.data[1,], lwd=2, col="royalblue")
points(ts2.data[1,], pch=18, cex=1.5, lwd=2, col="royalblue")
dev.off()
